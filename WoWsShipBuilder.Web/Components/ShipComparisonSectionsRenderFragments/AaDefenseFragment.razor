@using WoWsShipBuilder.ViewModels.Helper
@using WoWsShipBuilder.ViewModels.Other
@code {

    // Parameter needs to be named __builder, otherwise compilation will fail.
    // ReSharper disable once InconsistentNaming UnusedParameter.Local
    public static readonly RenderFragment<(Func<string, string, bool> IsColumnHidden, ILocalizer localizer)> AaDefenseDataFragment = element => __builder =>
    {
        string dataSectionString = ShipComparisonDataSections.AntiAir.ShipComparisonDataSectionToString();

        var columnTitleLongAura = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_LongAura))} ({element.localizer.SimpleAppLocalization(Translation.Unit_KM)})";
        var columnTitleLongAuraDps = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_LongAura))} {element.localizer.SimpleAppLocalization(Translation.Unit_DPS)}";
        var columnTitleLongAuraHitChance = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_LongAura))} {element.localizer.SimpleAppLocalization(Translation.ShipStats_HitChance)} ({element.localizer.SimpleAppLocalization(Translation.Unit_PerCent)})";
        var columnTitleFlaks = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_Flak))}";
        var columnTitleFlaksDamage = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_FlakDamage))}";
        var columnTitleMediumAura = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_MediumAura))} ({element.localizer.SimpleAppLocalization(Translation.Unit_KM)})";
        var columnTitleMediumAuraDps = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_MediumAura))} {element.localizer.SimpleAppLocalization(Translation.Unit_DPS)}";
        var columnTitleMediumAuraHitChance = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_MediumAura))} {element.localizer.SimpleAppLocalization(Translation.ShipStats_HitChance)} ({element.localizer.SimpleAppLocalization(Translation.Unit_PerCent)})";
        var columnTitleShortAura = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_ShortAura))} ({element.localizer.SimpleAppLocalization(Translation.Unit_KM)})";
        var columnTitleShortAuraDps = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_ShortAura))} {element.localizer.SimpleAppLocalization(Translation.Unit_DPS)}";
        var columnTitleShortAuraHitChance = $"{element.localizer.SimpleAppLocalization(nameof(Translation.ShipStats_ShortAura))} {element.localizer.SimpleAppLocalization(Translation.ShipStats_HitChance)} ({element.localizer.SimpleAppLocalization(Translation.Unit_PerCent)})";

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleLongAura}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleLongAura)" T="GridDataWrapper" Title="@columnTitleLongAura" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.LongAaRange is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.LongAaRange
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleLongAuraDps}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleLongAuraDps)" T="GridDataWrapper" Title="@columnTitleLongAuraDps" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.LongAaConstantDamage is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.LongAaConstantDamage
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleLongAuraHitChance}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleLongAuraHitChance)" T="GridDataWrapper" Title="@columnTitleLongAuraHitChance" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.LongAaHitChance is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.LongAaHitChance
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleFlaks}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleFlaks)" T="GridDataWrapper" Title="@columnTitleFlaks" HeaderClass="column-text-center" CellClass="column-text-center" SortBy="@(x => int.Parse(x.Flak?.Split(" ± ").First() ?? "0"))">
            <CellTemplate>
                @if (!string.IsNullOrEmpty(context.Item.Flak))
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.Flak
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleFlaksDamage}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleFlaksDamage)" T="GridDataWrapper" Title="@columnTitleFlaksDamage" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.FlakDamage is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.FlakDamage
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleMediumAura}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleMediumAura)" T="GridDataWrapper" Title="@columnTitleMediumAura" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.MediumAaRange is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.MediumAaRange
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleMediumAuraDps}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleMediumAuraDps)" T="GridDataWrapper" Title="@columnTitleMediumAuraDps" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.MediumAaConstantDamage is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.MediumAaConstantDamage
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleMediumAuraHitChance}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleMediumAuraHitChance)" T="GridDataWrapper" Title="@columnTitleMediumAuraHitChance" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.MediumAaHitChance is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.MediumAaHitChance
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleShortAura}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleShortAura)" T="GridDataWrapper" Title="@columnTitleShortAura" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.ShortAaRange is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.ShortAaRange
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleShortAuraDps}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleShortAuraDps)" T="GridDataWrapper" Title="@columnTitleShortAuraDps" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.ShortAaConstantDamage is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.ShortAaConstantDamage
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>

        <TemplateColumn ID="@($"{dataSectionString}_{columnTitleShortAuraHitChance}")" Hidden="@element.IsColumnHidden.Invoke(dataSectionString, columnTitleShortAuraHitChance)" T="GridDataWrapper" Title="@columnTitleShortAuraHitChance" HeaderClass="column-text-center" CellClass="column-text-center">
            <CellTemplate>
                @if (context.Item.ShortAaHitChance is not null)
                {
                    <MudText Typo="Typo.body2">
                        @context.Item.ShortAaHitChance
                    </MudText>
                }
                else
                {
                    <MudText Typo="Typo.body2" Color="Color.Primary">
                        @ShipComparisonViewModel.DataNotAvailable
                    </MudText>
                }
            </CellTemplate>
        </TemplateColumn>
    };
}